From 777888999aaa Mon Sep 21 00:00:00 2025
Subject: fix(launch.ps1): correct npm path resolution, avoid array errors

---
 scripts/launch.ps1 | 21 +++++++++++++++------
 1 file changed, 15 insertions(+), 6 deletions(-)

diff --git a/scripts/launch.ps1 b/scripts/launch.ps1
index 4444444..7777777 100644
--- a/scripts/launch.ps1
+++ b/scripts/launch.ps1
@@
-Write-Log "[+] Checking Node portable..."
-$nodeExe = Get-ChildItem "$here\..\node-portable\node-v*\win-x64\node.exe" -Recurse -ErrorAction SilentlyContinue | Select-Object -First 1
-if (-not $nodeExe) { throw "Node portable not found" }
-
-$npmCmd = Join-Path (Split-Path $nodeExe.FullName) "npm.cmd"
-if (-not (Test-Path $npmCmd)) {
-  Write-Log "[!] npm.cmd not in portable bundle, falling back to system npm"
-  $npmCmd = (Get-Command npm -ErrorAction SilentlyContinue).Source
-  if (-not $npmCmd) { throw "No npm found" }
-}
-
-Write-Log "[+] Node:  $(& $nodeExe.FullName --version)"
-Write-Log "[+] npm:   $(& $npmCmd --version)"
+Write-Log "[+] Checking Node portable..."
+$nodeExe = Get-ChildItem "$here\..\node-portable\node-v*\win-x64\node.exe" -Recurse |
+           Select-Object -First 1
+
+if (-not $nodeExe) {
+  throw "Node portable not found under node-portable folder."
+}
+
+$nodeDir = Split-Path $nodeExe.FullName
+$npmCmd  = Join-Path $nodeDir "npm.cmd"
+
+if (-not (Test-Path $npmCmd)) {
+  Write-Log "[!] npm.cmd not found next to node.exe, falling back to system npm"
+  $npmCmd = (Get-Command npm -ErrorAction SilentlyContinue).Source
+  if (-not $npmCmd) { throw "No npm found (portable or system)" }
+}
+
+Write-Log "[+] Node:  $(& $nodeExe.FullName --version)"
+Write-Log "[+] npm:   $(& $npmCmd --version)"
